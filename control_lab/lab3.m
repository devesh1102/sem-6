Mp=0.027;
lp=0.153;
%Lp=0.191;
r=0.08260;
 Jm=3.00E-005;
Marm=0.028;
g=9.810;
Jeq=1.23E-004;
Jp=1.10E-004;
Beq=0.000;
Bp=0.000;
Rm=3.30;
Kt=0.02797;
Km=0.02797;
den =(Jp*Jeq+Mp*lp*lp*Jeq+Jp*Mp*r*r);
A32 =r*((Mp*lp)^2) * g/den;
A33 = Kt*Km*(Jp+Mp*lp*lp)/(den*Rm);
A42 = Mp*lp*g*(Jeq + Mp*r*r)/(den);
A43 = Mp*lp*Kt*Km*r/(den*Rm);
A =[0 0 1 0;0 0 0 1;0 A32 -1*A33 0; 0 A42 -1*A43 0];
B3 = Kt*(Jp+Mp*lp*lp)/(den*Rm);
B4 = Mp*lp*Kt*r/(den*Rm);
B = [0;0;B3;B4];
C = [1 0 0 0;0 1 0 0 ;0 0 1 0; 0 0 0 1];
D= [0;0;0;0];
system = ss(A,B,C,D);
%Q represent weights to the different states
Q1= 40;
Q2=30;
Q3=4;
Q4=20;
Q = [Q1 0 0 0 ;0 Q2 0 0 ; 0 0 Q3 0 ; 0 0 0 Q4 ];
R =1;
K  = lqr(A,B,Q,R) 
